> feedeliza-plus@1.0.0 start
> node server.js
2025-09-13 22:08:09 [info]: 	âœ… ConexÃ£o com banco de dados estabelecida
2025-09-13 22:08:14 [info]: 	ðŸš€ Servidor rodando na porta 5000
Redis Client Connected
2025-09-13 22:08:19 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:19 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:19 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:19 +0000] "OPTIONS /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics?period=30d HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:general:dashboard, actionKey: read, isSuperadmin: true
2025-09-13 22:08:20 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:20 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:20 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:20 +0000] "GET /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics?period=30d HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:30 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:30 +0000] "OPTIONS /api/auth/me HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:30 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:30 +0000] "GET /api/auth/me HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:31 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:31 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:general:dashboard, actionKey: read, isSuperadmin: true
2025-09-13 22:08:31 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:31 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:39 +0000] "OPTIONS /api/auth/login HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:40 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:40 +0000] "POST /api/auth/login HTTP/1.1" 200 1516 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:40 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:40 +0000] "OPTIONS /api/iam/tree?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Building permission snapshot for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc
2025-09-13 22:08:41 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:41 +0000] "GET /api/iam/tree?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 200 91225 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:42 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:42 +0000] "OPTIONS /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics?period=30d HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:42 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:42 +0000] "GET /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics?period=30d HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:47 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:47 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:checkin:settings, actionKey: read, isSuperadmin: true
2025-09-13 22:08:47 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:47 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:47 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:47 +0000] "OPTIONS /api/settings/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:47 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:47 +0000] "OPTIONS /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Reward.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 1)
    at async Reward.findAndCountAll (/app/node_modules/sequelize/lib/model.js:1322:27)
    at async Object.listRewards (/app/src/domains/rewards/rewards.service.js:10:33)
    at async listRewards (/app/src/domains/rewards/rewards.controller.js:20:30)
2025-09-13 22:08:48 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:48 +0000] "GET /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:48 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:48 +0000] "GET /api/settings/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:49 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:49 +0000] "GET /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Reward.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 1)
    at async Reward.findAndCountAll (/app/node_modules/sequelize/lib/model.js:1322:27)
    at async Object.listRewards (/app/src/domains/rewards/rewards.service.js:10:33)
    at async listRewards (/app/src/domains/rewards/rewards.controller.js:20:30)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:general:monthly-summary, actionKey: read, isSuperadmin: true
2025-09-13 22:08:50 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:50 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:50 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:50 +0000] "OPTIONS /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:50 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:50 +0000] "OPTIONS /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:50 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:50 +0000] "OPTIONS /api/dashboard/rewards-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:51 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:51 +0000] "GET /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 0)
    at async Object.getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.service.js:280:13)
    at async getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.controller.js:31:26)
2025-09-13 22:08:51 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:51 +0000] "GET /api/dashboard/23531a9c-171b-4939-b4ee-e9c6eabe92bc/analytics HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:51 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:51 +0000] "GET /api/dashboard/rewards-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.rawSelect (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:434:18)
    at async Reward.aggregate (/app/node_modules/sequelize/lib/model.js:1277:19)
    at async Reward.count (/app/node_modules/sequelize/lib/model.js:1306:20)
    at async Object.getRewardsAnalytics (/app/src/domains/rewards/rewards.service.js:194:31)
    at async Object.getRewardsAnalytics (/app/src/domains/dashboard/dashboard.service.js:114:16)
    at async getRewardsAnalytics (/app/src/domains/dashboard/dashboard.controller.js:24:26)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:52 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:52 +0000] "GET /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 0)
    at async Object.getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.service.js:280:13)
    at async getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.controller.js:31:26)
2025-09-13 22:08:52 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:52 +0000] "GET /api/dashboard/rewards-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.rawSelect (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:434:18)
    at async Reward.aggregate (/app/node_modules/sequelize/lib/model.js:1277:19)
    at async Reward.count (/app/node_modules/sequelize/lib/model.js:1306:20)
    at async Object.getRewardsAnalytics (/app/src/domains/rewards/rewards.service.js:194:31)
    at async Object.getRewardsAnalytics (/app/src/domains/dashboard/dashboard.service.js:114:16)
    at async getRewardsAnalytics (/app/src/domains/dashboard/dashboard.controller.js:24:26)
2025-09-13 22:08:56 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:56 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:general:satisfaction-overview, actionKey: read, isSuperadmin: true
2025-09-13 22:08:56 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:56 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:56 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:56 +0000] "OPTIONS /api/surveys/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:56 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:56 +0000] "OPTIONS /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:08:56 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:56 +0000] "OPTIONS /api/dashboard/rating-distribution?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13 HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:57 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:57 +0000] "GET /api/surveys/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error: WHERE parameter "id" has invalid "undefined" value
    at PostgresQueryGenerator.whereItemQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1746:13)
    at /app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1737:25
    at Array.forEach (<anonymous>)
    at PostgresQueryGenerator.whereItemsQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1735:35)
    at PostgresQueryGenerator.getWhereConditions (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:2078:19)
    at PostgresQueryGenerator.selectQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:991:28)
    at PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:59)
    at Survey.findAll (/app/node_modules/sequelize/lib/model.js:1140:47)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Survey.findOne (/app/node_modules/sequelize/lib/model.js:1240:12)
2025-09-13 22:08:57 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:57 +0000] "GET /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 0)
    at async Object.getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.service.js:280:13)
    at async getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.controller.js:31:26)
2025-09-13 22:08:57 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:57 +0000] "GET /api/dashboard/rating-distribution?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13 HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:58 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:58 +0000] "GET /api/surveys/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error: WHERE parameter "id" has invalid "undefined" value
    at PostgresQueryGenerator.whereItemQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1746:13)
    at /app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1737:25
    at Array.forEach (<anonymous>)
    at PostgresQueryGenerator.whereItemsQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:1735:35)
    at PostgresQueryGenerator.getWhereConditions (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:2078:19)
    at PostgresQueryGenerator.selectQuery (/app/node_modules/sequelize/lib/dialects/abstract/query-generator.js:991:28)
    at PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:59)
    at Survey.findAll (/app/node_modules/sequelize/lib/model.js:1140:47)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Survey.findOne (/app/node_modules/sequelize/lib/model.js:1240:12)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:08:58 [info]: 	170.254.46.100 - - [13/Sep/2025:22:08:58 +0000] "GET /api/dashboard/evolution-analytics?restaurantId=23531a9c-171b-4939-b4ee-e9c6eabe92bc&start_date=2024-09-13&end_date=2025-09-13&granularity=month HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 0)
    at async Object.getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.service.js:280:13)
    at async getEvolutionAnalytics (/app/src/domains/dashboard/dashboard.controller.js:31:26)
2025-09-13 22:09:02 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:02 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:general:surveys-comparison, actionKey: read, isSuperadmin: true
2025-09-13 22:09:02 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:02 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:02 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:02 +0000] "OPTIONS /api/surveys?restaurant_id=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:03 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:03 +0000] "GET /api/surveys?restaurant_id=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Survey.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async listSurveys (/app/src/domains/surveys/surveys.controller.js:19:33)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:04 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:04 +0000] "GET /api/surveys?restaurant_id=23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Survey.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async listSurveys (/app/src/domains/surveys/surveys.controller.js:19:33)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:checkin:dashboard, actionKey: read, isSuperadmin: true
2025-09-13 22:09:07 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:07 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:07 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:07 +0000] "OPTIONS /api/checkin/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:08 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:08 +0000] "GET /api/checkin/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Object.getCheckinAnalytics (/app/src/domains/checkin/checkin.service.js:316:39)
    at async getCheckinAnalytics (/app/src/domains/checkin/checkin.controller.js:67:31)
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:09 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:09 +0000] "GET /api/checkin/analytics/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Checkin.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Object.getCheckinAnalytics (/app/src/domains/checkin/checkin.service.js:316:39)
    at async getCheckinAnalytics (/app/src/domains/checkin/checkin.controller.js:67:31)
2025-09-13 22:09:17 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:17 +0000] "OPTIONS /api/settings/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:17 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:17 +0000] "OPTIONS /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:17 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:17 +0000] "GET /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Reward.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 1)
    at async Reward.findAndCountAll (/app/node_modules/sequelize/lib/model.js:1322:27)
    at async Object.listRewards (/app/src/domains/rewards/rewards.service.js:10:33)
    at async listRewards (/app/src/domains/rewards/rewards.controller.js:20:30)
2025-09-13 22:09:17 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:17 +0000] "GET /api/settings/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 304 - "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:18 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:18 +0000] "GET /api/rewards/restaurant/23531a9c-171b-4939-b4ee-e9c6eabe92bc HTTP/1.1" 500 148 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.select (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:407:12)
    at async Reward.findAll (/app/node_modules/sequelize/lib/model.js:1140:21)
    at async Promise.all (index 1)
    at async Reward.findAndCountAll (/app/node_modules/sequelize/lib/model.js:1322:27)
    at async Object.listRewards (/app/src/domains/rewards/rewards.service.js:10:33)
    at async listRewards (/app/src/domains/rewards/rewards.controller.js:20:30)
2025-09-13 22:09:22 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:22 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: fidelity:checkin:active, actionKey: read, isSuperadmin: true
2025-09-13 22:09:23 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:23 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:38 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:38 +0000] "OPTIONS /api/iam/check HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
[IamService] Checking permission for userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c, restaurantId: 23531a9c-171b-4939-b4ee-e9c6eabe92bc, featureKey: restaurants, actionKey: read, isSuperadmin: true
2025-09-13 22:09:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:39 +0000] "POST /api/iam/check HTTP/1.1" 200 60 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:39 +0000] "OPTIONS /api/admin/users HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:39 +0000] "OPTIONS /api/admin/restaurants HTTP/1.1" 204 0 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
Decoded userId: 2f4768e9-6bbb-489b-a1a4-6a4678afdc3c
2025-09-13 22:09:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:39 +0000] "GET /api/admin/users HTTP/1.1" 200 585 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"
2025-09-13 22:09:39 [info]: 	170.254.46.100 - - [13/Sep/2025:22:09:39 +0000] "GET /api/admin/restaurants HTTP/1.1" 200 494 "https://feedelizapro.towersfy.com/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36"