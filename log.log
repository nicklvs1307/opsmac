    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5151111111',
      '2025-07-31 12:18:51.365 +00:00',
      'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
    ]
  },
  original: error: value "5151111111" is out of range for type integer
      at Parser.parseErrorMessage (/app/node_modules/pg-protocol/dist/parser.js:285:98)
      at Parser.handlePacket (/app/node_modules/pg-protocol/dist/parser.js:122:29)
      at Parser.parse (/app/node_modules/pg-protocol/dist/parser.js:35:38)
      at Socket.<anonymous> (/app/node_modules/pg-protocol/dist/index.js:11:42)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:191:23) {
    length: 148,
    severity: 'ERROR',
    code: '22003',
    detail: undefined,
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: "unnamed portal parameter $1 = '...'",
    schema: undefined,
    table: undefined,
    column: undefined,
    dataType: undefined,
    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5151111111',
      '2025-07-31 12:18:51.365 +00:00',
      'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
    ]
  },
  sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
  parameters: [
    '5151111111',
    '2025-07-31 12:18:51.365 +00:00',
    'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
  ]
}
[Public Check-in] RequisiÃ§Ã£o recebida: {
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc',
  phone_number: '5535998374007',
  cpf: undefined,
  customer_name: 'Lucas Niquele'
}
[Public Check-in] Restaurante encontrado: Tower Test Settings: {
  nps_enabled: true,
  tablet_mode: false,
  auto_response: true,
  rewards_enabled: true,
  feedback_enabled: true,
  whatsapp_enabled: true,
  whatsapp_messages: {
    checkin_message_text: '',
    coupon_reminder_text: '',
    birthday_greeting_text: '',
    checkin_message_enabled: false,
    coupon_reminder_enabled: false,
    feedback_thank_you_text: '',
    birthday_greeting_enabled: false,
    feedback_thank_you_enabled: false
  },
  feedback_thank_you_text: '',
  checkin_program_settings: {
    enable_ranking: true,
    rewards_per_visit: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object]
    ],
    checkin_cycle_name: 'Check in Roma ',
    points_per_checkin: '1',
    checkin_cycle_length: '6',
    allow_multiple_cycles: true,
    identification_method: 'phone',
    checkin_limit_per_cycle: '',
    checkin_duration_minutes: '1',
    checkin_time_restriction: 'unlimited',
    enable_level_progression: true
  },
  feedback_thank_you_enabled: false
}
[Public Check-in] MÃ©todo de IdentificaÃ§Ã£o: phone
[Public Check-in] CritÃ©rio de busca do cliente: {
  phone: '5535998374007',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
[Public Check-in] Cliente encontrado: c0463aa7-193d-42fc-9163-aa9c850a0546 Lucas
[Public Check-in] Check-in criado: 0fd91e53-2573-42ff-8c74-b22703d4068c
[Public Check-in] total_visits do cliente incrementado para: 4
[Public Check-in] ConfiguraÃ§Ãµes do Programa de Check-in: {
  "enable_ranking": true,
  "rewards_per_visit": [
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "1",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "2",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "3",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "4",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "5",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "6",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "7",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "8",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "9",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "10",
      "message_template": "ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"
    }
  ],
  "checkin_cycle_name": "Check in Roma ",
  "points_per_checkin": "1",
  "checkin_cycle_length": "6",
  "allow_multiple_cycles": true,
  "identification_method": "phone",
  "checkin_limit_per_cycle": "",
  "checkin_duration_minutes": "1",
  "checkin_time_restriction": "unlimited",
  "enable_level_progression": true
}
[Public Check-in] Cliente Lucas ganhou 1 pontos por check-in.
[Public Check-in] Recompensas por Visita configuradas: [
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '1',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '2',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '3',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '4',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '5',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '6',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '7',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '8',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '9',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  },
  {
    reward_id: '13a05a88-abbc-446f-90cb-042de6b8463b',
    visit_count: '10',
    message_template: 'ğŸ“£ ParabÃ©ns, {{customer_name}}!\n' +
      'VocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n' +

      '\n' +
      'ğŸ† Recompensa: {{reward_title}}\n' +
      'ğŸŸï¸ Cupom: {{coupon_code}}\n' +
      'ğŸ“ Check-in nÃºmero: {{visit_count}}\n' +

      '\n' +
      'Mostre esse cupom no balcÃ£o e aproveite sua recompensa!\n' +
      'Continue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n' +

      '\n' +
      '#ClubeRoma #VocÃªMerece'
  }
]
[Public Check-in] Visitas atuais do cliente: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"1","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 1 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"2","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 2 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"3","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 3 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"4","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 4 (parsed) vs currentVisits: 4
[Public Check-in] CorrespondÃªncia encontrada para visit_count: 4. Tentando buscar recompensa com ID: 13a05a88-abbc-446f-90cb-042de6b8463b
[Public Check-in] Recompensa encontrada: Chopp Gratis Objeto Reward: {"id":"13a05a88-abbc-446f-90cb-042de6b8463b","title":"Chopp Gratis","description":"1","reward_type":"free_item","value":"1.00","points_required":1,"max_uses_per_customer":1,"total_uses_limit":null,"current_uses":0,"minimum_purchase":null,"applicable_items":[],"excluded_items":[],"valid_from":"2025-07-31T00:41:24.188Z","valid_until":"2025-07-31T00:40:00.000Z","days_valid":null,"auto_apply":false,"requires_approval":false,"is_active":true,"is_featured":false,"image":null,"terms_conditions":null,"trigger_conditions":{},"notification_settings":{"send_push":false,"send_email":true,"send_whatsapp":false,"custom_message":""},"analytics":{"total_redeemed":1,"redemption_rate":0,"total_generated":0,"average_order_value":0,"customer_satisfaction":0},"restaurant_id":"0e517dc5-4881-45aa-996e-0365012000bc","customer_id":null,"created_by":"211aab5d-fb9a-421b-991c-fcda8bc44051","createdAt":"2025-07-31T00:41:24.189Z","updatedAt":"2025-07-31T11:31:24.073Z"}
[Public Check-in] Tentando gerar cupom para o cliente: c0463aa7-193d-42fc-9163-aa9c850a0546
[Public Check-in] Erro ao gerar cupom de recompensa por visita para Lucas: Cliente nÃ£o pode usar esta recompensa Stack: Error: Cliente nÃ£o pode usar esta recompensa
    at Reward.generateCoupon (/app/backend/models/Reward.js:273:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /app/backend/routes/checkin.js:338:31
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"5","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 5 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"6","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 6 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"7","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 7 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"8","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 8 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"9","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 9 (parsed) vs currentVisits: 4
[Public Check-in] Processando rewardConfig: {"reward_id":"13a05a88-abbc-446f-90cb-042de6b8463b","visit_count":"10","message_template":"ğŸ“£ ParabÃ©ns, {{customer_name}}!\nVocÃª acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! ğŸ‰\n\nğŸ† Recompensa: {{reward_title}}\nğŸŸï¸ Cupom: {{coupon_code}}\nğŸ“ Check-in nÃºmero: {{visit_count}}\n\nMostre esse cupom no balcÃ£o e aproveite sua recompensa!\nContinue participando, porque tem mais prÃªmios te esperando. ğŸ’œ\n\n#ClubeRoma #VocÃªMerece"}
[Public Check-in] Verificando recompensa para visit_count: 10 (parsed) vs currentVisits: 4