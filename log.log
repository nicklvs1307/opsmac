> Feedeliza+@1.0.0 start
> node backend/server.js
Swagger JSDoc options.apis: [ '/app/backend/routes/*.js' ]
Generated Swagger Specs (first 500 chars): {
  "openapi": "3.0.0",
  "info": {
    "title": "Check Test API",
    "version": "1.0.0",
    "description": "API documentation for the Check Test application."
  },
  "servers": [
    {
      "url": "https://feedelizaapi.towersfy.com/api",
      "description": "Production server"
    }
  ],
  "tags": [
    {
      "name": "Public API",
      "description": "Endpoints acessÃ­veis via API Token para integraÃ§Ã£o externa."
    },
    {
      "name": "Admin",
      "description": "Gerenciamento de us
âœ… ConexÃ£o com banco de dados estabelecida
âœ… Modelos sincronizados com o banco
ðŸš€ Servidor rodando na porta 5000
ðŸ“Š Dashboard: https://feedelizapro.towersfy.com
ðŸ”— API: https://feedelizaapi.towersfy.com/api
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Erro ao girar a roleta: ReferenceError: winningIndex is not defined
    at Reward.generateCoupon (/app/backend/models/Reward.js:350:35)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /app/backend/routes/rewards.js:114:55
Erro ao girar a roleta: ReferenceError: winningIndex is not defined
    at Reward.generateCoupon (/app/backend/models/Reward.js:350:35)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /app/backend/routes/rewards.js:114:55
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Erro: Error: ENOENT: no such file or directory, open 'public/uploads/logo-1754157101843-882584874.jpeg'
Erro ao girar a roleta: ReferenceError: winningIndex is not defined
    at Reward.generateCoupon (/app/backend/models/Reward.js:350:35)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /app/backend/routes/rewards.js:114:55
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
totalCheckins: 21
mostFrequentCustomers: [
  Checkin {
    dataValues: {
      customer_id: 'c0463aa7-193d-42fc-9163-aa9c850a0546',
      checkin_count: '9',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: 'c0463aa7-193d-42fc-9163-aa9c850a0546',
      checkin_count: '9',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: 'd11fc920-e0e3-4335-98c6-73acf48b06ad',
      checkin_count: '5',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: 'd11fc920-e0e3-4335-98c6-73acf48b06ad',
      checkin_count: '5',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: '51a4ce76-a58b-4b4a-9636-888f54403d04',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: '51a4ce76-a58b-4b4a-9636-888f54403d04',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: '89faa009-4362-4bd1-8fc3-fa77657f20f9',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: '89faa009-4362-4bd1-8fc3-fa77657f20f9',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: 'aa439eb6-375d-4d64-a485-3ba157ca285f',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: 'aa439eb6-375d-4d64-a485-3ba157ca285f',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: 'eea6a099-edc3-456a-a14c-bea7bac9d6fe',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: 'eea6a099-edc3-456a-a14c-bea7bac9d6fe',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: '0bbd5d0d-c188-46ec-ae48-018f65b7dc84',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: '0bbd5d0d-c188-46ec-ae48-018f65b7dc84',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: 'fcc873c0-c553-4b7b-9118-7df02b105fda',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: 'fcc873c0-c553-4b7b-9118-7df02b105fda',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  },
  Checkin {
    dataValues: {
      customer_id: '292c7b7d-8828-42e0-98ec-b677f6c5ea00',
      checkin_count: '1',
      customer: [Customer]
    },
    _previousDataValues: {
      customer_id: '292c7b7d-8828-42e0-98ec-b677f6c5ea00',
      checkin_count: '1',
      customer: [Customer]
    },
    uniqno: 1,
    _changed: Set(0) {},
    _options: {
      isNewRecord: false,
      _schema: null,
      _schemaDelimiter: '',
      include: [Array],
      includeNames: [Array],
      includeMap: [Object],
      includeValidated: true,
      attributes: [Array],
      raw: true
    },
    isNewRecord: false,
    customer: Customer {
      dataValues: [Object],
      _previousDataValues: [Object],
      uniqno: 1,
      _changed: Set(0) {},
      _options: [Object],
      isNewRecord: false
    }
  }
]
averageVisitDuration: { avg_duration_seconds: '7398.1151428571428571' }
checkinsByDay: [
  { date: 2025-07-30T00:00:00.000Z, count: '5' },
  { date: 2025-07-31T00:00:00.000Z, count: '7' },
  { date: 2025-08-01T00:00:00.000Z, count: '7' },
  { date: 2025-08-02T00:00:00.000Z, count: '2' }
]
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Erro ao criar recompensa: ValidationError [SequelizeValidationError]: notNull Violation: Reward.created_by cannot be null
    at InstanceValidator._validate (/app/node_modules/sequelize/lib/instance-validator.js:50:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async InstanceValidator._validateAndRunHooks (/app/node_modules/sequelize/lib/instance-validator.js:60:7)
    at async InstanceValidator.validate (/app/node_modules/sequelize/lib/instance-validator.js:54:12)
    at async model.save (/app/node_modules/sequelize/lib/model.js:2426:7)
    at async Reward.create (/app/node_modules/sequelize/lib/model.js:1362:12)
    at async /app/backend/routes/rewards.js:49:24 {
  errors: [
    ValidationErrorItem {
      message: 'Reward.created_by cannot be null',
      type: 'notNull Violation',
      path: 'created_by',
      value: null,
      origin: 'CORE',
      instance: [Reward],
      validatorKey: 'is_null',
      validatorName: null,
      validatorArgs: []
    }
  ]
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Erro ao listar cupons: EagerLoadingError [SequelizeEagerLoadingError]: Reward is not associated to Coupon!
    at Coupon._getIncludedAssociation (/app/node_modules/sequelize/lib/model.js:565:13)
    at Coupon._validateIncludedElement (/app/node_modules/sequelize/lib/model.js:502:53)
    at /app/node_modules/sequelize/lib/model.js:421:37
    at Array.map (<anonymous>)
    at Coupon._validateIncludedElements (/app/node_modules/sequelize/lib/model.js:417:39)
    at Coupon.aggregate (/app/node_modules/sequelize/lib/model.js:1252:12)
    at Coupon.count (/app/node_modules/sequelize/lib/model.js:1306:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Promise.all (index 0)
    at async Coupon.findAndCountAll (/app/node_modules/sequelize/lib/model.js:1322:27)
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Erro ao buscar analytics de cupons: EagerLoadingError [SequelizeEagerLoadingError]: Reward is not associated to Coupon!
    at Coupon._getIncludedAssociation (/app/node_modules/sequelize/lib/model.js:565:13)
    at Coupon._validateIncludedElement (/app/node_modules/sequelize/lib/model.js:502:53)
    at /app/node_modules/sequelize/lib/model.js:421:37
    at Array.map (<anonymous>)
    at Coupon._validateIncludedElements (/app/node_modules/sequelize/lib/model.js:417:39)
    at Coupon.findAll (/app/node_modules/sequelize/lib/model.js:1124:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async /app/backend/routes/coupons.js:301:33