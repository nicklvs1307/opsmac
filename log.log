      "visit_count": "10",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "11",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    }
  ],
  "checkin_cycle_name": "Check in Roma ",
  "points_per_checkin": "1",
  "checkin_cycle_length": "6",
  "allow_multiple_cycles": true,
  "identification_method": "phone",
  "checkin_limit_per_cycle": "",
  "checkin_duration_minutes": "1",
  "checkin_time_restriction": "unlimited",
  "enable_level_progression": true
}
[Public Check-in] Erro ao registrar check-in público: Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.update (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:355:12)
    at async model.save (/app/node_modules/sequelize/lib/model.js:2490:35)
    at async model.update (/app/node_modules/sequelize/lib/model.js:2598:12)
    at async Customer.addLoyaltyPoints (/app/backend/models/Customer.js:283:5)
    at async /app/backend/routes/checkin.js:300:9 {
  name: 'SequelizeDatabaseError',
  parent: error: value "5151111111" is out of range for type integer
      at Parser.parseErrorMessage (/app/node_modules/pg-protocol/dist/parser.js:285:98)
      at Parser.handlePacket (/app/node_modules/pg-protocol/dist/parser.js:122:29)
      at Parser.parse (/app/node_modules/pg-protocol/dist/parser.js:35:38)
      at Socket.<anonymous> (/app/node_modules/pg-protocol/dist/index.js:11:42)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:191:23) {
    length: 148,
    severity: 'ERROR',
    code: '22003',
    detail: undefined,
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: "unnamed portal parameter $1 = '...'",
    schema: undefined,
    table: undefined,
    column: undefined,
    dataType: undefined,
    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5151111111',
      '2025-07-31 13:16:15.577 +00:00',
      'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
    ]
  },
  original: error: value "5151111111" is out of range for type integer
      at Parser.parseErrorMessage (/app/node_modules/pg-protocol/dist/parser.js:285:98)
      at Parser.handlePacket (/app/node_modules/pg-protocol/dist/parser.js:122:29)
      at Parser.parse (/app/node_modules/pg-protocol/dist/parser.js:35:38)
      at Socket.<anonymous> (/app/node_modules/pg-protocol/dist/index.js:11:42)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:191:23) {
    length: 148,
    severity: 'ERROR',
    code: '22003',
    detail: undefined,
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: "unnamed portal parameter $1 = '...'",
    schema: undefined,
    table: undefined,
    column: undefined,
    dataType: undefined,
    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5151111111',
      '2025-07-31 13:16:15.577 +00:00',
      'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
    ]
  },
  sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
  parameters: [
    '5151111111',
    '2025-07-31 13:16:15.577 +00:00',
    'db819d2e-b0ee-4a65-8f5c-aca7cfd41a17'
  ]
}
[Public Check-in] Requisição recebida: {
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc',
  phone_number: '5535998374007',
  cpf: undefined,
  customer_name: 'Lucas Niquele'
}
[Public Check-in] Restaurante encontrado: Tower Test Settings: {
  nps_enabled: true,
  tablet_mode: false,
  auto_response: true,
  rewards_enabled: true,
  feedback_enabled: true,
  whatsapp_enabled: true,
  whatsapp_messages: {
    checkin_message_text: '',
    coupon_reminder_text: '',
    birthday_greeting_text: '',
    checkin_message_enabled: false,
    coupon_reminder_enabled: false,
    feedback_thank_you_text: '',
    birthday_greeting_enabled: false,
    feedback_thank_you_enabled: false
  },
  feedback_thank_you_text: '',
  checkin_program_settings: {
    enable_ranking: true,
    rewards_per_visit: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ],
    checkin_cycle_name: 'Check in Roma ',
    points_per_checkin: '1',
    checkin_cycle_length: '6',
    allow_multiple_cycles: true,
    identification_method: 'phone',
    checkin_limit_per_cycle: '',
    checkin_duration_minutes: '1',
    checkin_time_restriction: 'unlimited',
    enable_level_progression: true
  },
  feedback_thank_you_enabled: false
}
[Public Check-in] Método de Identificação: phone
[Public Check-in] Critério de busca do cliente: {
  phone: '5535998374007',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
[Public Check-in] Cliente encontrado: c0463aa7-193d-42fc-9163-aa9c850a0546 Lucas
[Public Check-in] Cliente já possui um check-in ativo: c0463aa7-193d-42fc-9163-aa9c850a0546
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
Auth Middleware - req.user (after population): {
  userId: '211aab5d-fb9a-421b-991c-fcda8bc44051',
  email: 'lucas@teste.com',
  role: 'owner',
  name: 'Lucas Niquele',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
[Public Check-in] Requisição recebida: {
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc',
  phone_number: '5535998374007',
  cpf: undefined,
  customer_name: 'Lucas Niquele'
}
[Public Check-in] Restaurante encontrado: Tower Test Settings: {
  nps_enabled: true,
  tablet_mode: false,
  auto_response: true,
  rewards_enabled: true,
  feedback_enabled: true,
  whatsapp_enabled: true,
  whatsapp_messages: {
    checkin_message_text: '',
    coupon_reminder_text: '',
    birthday_greeting_text: '',
    checkin_message_enabled: false,
    coupon_reminder_enabled: false,
    feedback_thank_you_text: '',
    birthday_greeting_enabled: false,
    feedback_thank_you_enabled: false
  },
  feedback_thank_you_text: '',
  checkin_program_settings: {
    enable_ranking: true,
    rewards_per_visit: [
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object], [Object],
      [Object]
    ],
    checkin_cycle_name: 'Check in Roma ',
    points_per_checkin: '1',
    checkin_cycle_length: '6',
    allow_multiple_cycles: true,
    identification_method: 'phone',
    checkin_limit_per_cycle: '',
    checkin_duration_minutes: '1',
    checkin_time_restriction: 'unlimited',
    enable_level_progression: true
  },
  feedback_thank_you_enabled: false
}
[Public Check-in] Método de Identificação: phone
[Public Check-in] Critério de busca do cliente: {
  phone: '5535998374007',
  restaurant_id: '0e517dc5-4881-45aa-996e-0365012000bc'
}
[Public Check-in] Cliente encontrado: c0463aa7-193d-42fc-9163-aa9c850a0546 Lucas
[Public Check-in] Check-in criado: 249ff327-a52c-4627-b316-7c2a7a49ddb5
[Public Check-in] total_visits do cliente incrementado para: 11
[Public Check-in] Configurações do Programa de Check-in: {
  "enable_ranking": true,
  "rewards_per_visit": [
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "12",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "13",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "14",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "4",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "5",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "6",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "1ef6aa44-c5da-4db0-b304-a348757228b9",
      "visit_count": "7",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "8",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "9",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "10",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    },
    {
      "reward_id": "13a05a88-abbc-446f-90cb-042de6b8463b",
      "visit_count": "11",
      "message_template": "📣 Parabéns, {{customer_name}}!\nVocê acaba de conquistar uma nova recompensa aqui na {{restaurant_name}}! 🎉\n\n🏆 Recompensa: {{reward_title}}\n🎟️ Cupom: {{coupon_code}}\n📍 Check-in número: {{visit_count}}\n\nMostre esse cupom no balcão e aproveite sua recompensa!\nContinue participando, porque tem mais prêmios te esperando. 💜\n\n#ClubeRoma #VocêMerece"
    }
  ],
  "checkin_cycle_name": "Check in Roma ",
  "points_per_checkin": "1",
  "checkin_cycle_length": "6",
  "allow_multiple_cycles": true,
  "identification_method": "phone",
  "checkin_limit_per_cycle": "",
  "checkin_duration_minutes": "1",
  "checkin_time_restriction": "unlimited",
  "enable_level_progression": true
}
[Public Check-in] Erro ao registrar check-in público: Error
    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)
    at /app/node_modules/sequelize/lib/sequelize.js:315:28
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async PostgresQueryInterface.update (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:355:12)
    at async model.save (/app/node_modules/sequelize/lib/model.js:2490:35)
    at async model.update (/app/node_modules/sequelize/lib/model.js:2598:12)
    at async Customer.addLoyaltyPoints (/app/backend/models/Customer.js:283:5)
    at async /app/backend/routes/checkin.js:300:9 {
  name: 'SequelizeDatabaseError',
  parent: error: value "5011111111" is out of range for type integer
      at Parser.parseErrorMessage (/app/node_modules/pg-protocol/dist/parser.js:285:98)
      at Parser.handlePacket (/app/node_modules/pg-protocol/dist/parser.js:122:29)
      at Parser.parse (/app/node_modules/pg-protocol/dist/parser.js:35:38)
      at Socket.<anonymous> (/app/node_modules/pg-protocol/dist/index.js:11:42)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:191:23) {
    length: 148,
    severity: 'ERROR',
    code: '22003',
    detail: undefined,
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: "unnamed portal parameter $1 = '...'",
    schema: undefined,
    table: undefined,
    column: undefined,
    dataType: undefined,
    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5011111111',
      '2025-07-31 13:16:32.094 +00:00',
      'c0463aa7-193d-42fc-9163-aa9c850a0546'
    ]
  },
  original: error: value "5011111111" is out of range for type integer
      at Parser.parseErrorMessage (/app/node_modules/pg-protocol/dist/parser.js:285:98)
      at Parser.handlePacket (/app/node_modules/pg-protocol/dist/parser.js:122:29)
      at Parser.parse (/app/node_modules/pg-protocol/dist/parser.js:35:38)
      at Socket.<anonymous> (/app/node_modules/pg-protocol/dist/index.js:11:42)
      at Socket.emit (node:events:524:28)
      at addChunk (node:internal/streams/readable:561:12)
      at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
      at Readable.push (node:internal/streams/readable:392:5)
      at TCP.onStreamRead (node:internal/stream_base_commons:191:23) {
    length: 148,
    severity: 'ERROR',
    code: '22003',
    detail: undefined,
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: "unnamed portal parameter $1 = '...'",
    schema: undefined,
    table: undefined,
    column: undefined,
    dataType: undefined,
    constraint: undefined,
    file: 'numutils.c',
    line: '314',
    routine: 'pg_strtoint32',
    sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
    parameters: [
      '5011111111',
      '2025-07-31 13:16:32.094 +00:00',
      'c0463aa7-193d-42fc-9163-aa9c850a0546'
    ]
  },
  sql: 'UPDATE "customers" SET "loyalty_points"=$1,"updated_at"=$2 WHERE "id" = $3',
  parameters: [
    '5011111111',
    '2025-07-31 13:16:32.094 +00:00',
    'c0463aa7-193d-42fc-9163-aa9c850a0546'
  ]
}